# 更新日志 (Changelog)

## [v1.2.0] - 2025-08-12

### 新增功能 (Added)
- **括号位置控制**: 添加了新的UI控件，允许用户设置是否允许括号出现在等号右边
  - 新增复选框："允许括号出现在等号右边"
  - 支持4种括号位置：左操作数、右操作数、等号左边无括号、等号右边括号
  - 默认关闭右边括号功能，保持向后兼容性

### 修复 (Fixed)
- **随机数生成错误**: 修复了"empty range for randint()"错误
  - 在除法表达式生成中添加范围有效性检查
  - 在三数表达式生成中添加安全回退机制
  - 优化乘法和除法的数字范围计算逻辑
  - 添加`_generate_safe_random`方法作为安全回退

### 技术改进 (Technical Improvements)
- 重构了`_generate_bracket_expression`方法，支持更灵活的括号位置控制
- 优化了`MathEngine`类的参数传递机制
- 增强了边界条件处理，确保所有随机数生成都有有效范围
- 改进了UI布局，新增括号设置框架

### 文件变更 (Files Changed)
- `ui_generator.py`: 添加括号位置控制UI组件
- `math_engine.py`: 扩展括号生成逻辑，修复随机数范围错误
- `main.py`: 更新参数传递机制
- `constants.py`: 调整默认配置参数

### 兼容性 (Compatibility)
- 保持向后兼容，现有功能不受影响
- 新功能默认关闭，用户可选择启用

---

## 如何使用新功能

### 括号位置控制
1. 在UI界面中找到"括号设置"区域
2. 勾选"允许括号出现在等号右边"复选框
3. 生成的题目将包含形如 `5 + 3 = (     )` 的表达式

### 示例
- 传统模式：`(     ) + 5 = 10`, `5 + (     ) = 10`, `5 + 3 =`
- 新增模式：`5 + 3 = (     )`